<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MPCNC Plotter Console</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              ink: '#111827',
              mist: '#f8f5f0',
              breeze: '#e6f6f3',
              tide: '#0f766e',
              apricot: '#f59e0b'
            }
          }
        }
      };
    </script>
    <style>
      body {
        font-family: 'Space Grotesk', sans-serif;
      }
      .reveal {
        opacity: 0;
        transform: translateY(14px);
        animation: rise 0.6s ease-out forwards;
      }
      @keyframes rise {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-mist via-white to-breeze text-ink">
    <div class="pointer-events-none fixed inset-0">
      <div class="absolute -top-20 -left-20 h-72 w-72 rounded-full bg-apricot/30 blur-3xl"></div>
      <div class="absolute bottom-0 right-0 h-80 w-80 rounded-full bg-tide/20 blur-3xl"></div>
    </div>

    <div class="relative mx-auto flex max-w-6xl flex-col gap-8 px-6 py-10">
      <header class="reveal" style="animation-delay: 0.05s">
        <p class="text-sm uppercase tracking-[0.3em] text-tide/80">Plotter Control</p>
        <div class="mt-2 flex flex-col gap-4 lg:flex-row lg:items-end lg:justify-between">
          <div>
            <h1 class="text-4xl font-semibold leading-tight lg:text-5xl">MPCNC Live Console</h1>
            <p class="mt-3 max-w-xl text-base text-ink/70">
              Toggle dry-run, connect the serial link, and fire quick actions without leaving the
              stream.
            </p>
          </div>
          <div class="flex flex-wrap gap-3 text-sm text-ink/70">
            <div class="rounded-full border border-ink/10 bg-white/70 px-4 py-2 shadow-sm">
              API: <span id="status-text" class="font-semibold text-ink">Loading...</span>
            </div>
            <div class="rounded-full border border-ink/10 bg-white/70 px-4 py-2 shadow-sm">
              Dry Run: <span id="dryrun-text" class="font-semibold text-ink">--</span>
            </div>
            <div class="rounded-full border border-ink/10 bg-white/70 px-4 py-2 shadow-sm">
              Serial: <span id="serial-text" class="font-semibold text-ink">--</span>
            </div>
            <div class="rounded-full border border-ink/10 bg-white/70 px-4 py-2 shadow-sm">
              Worker: <span id="worker-text" class="font-semibold text-ink">--</span>
            </div>
          </div>
        </div>
      </header>

      <main class="grid gap-6 lg:grid-cols-[minmax(0,1fr)_minmax(0,1fr)]">
        <section
          class="reveal rounded-3xl border border-ink/10 bg-white/80 p-6 shadow-lg shadow-ink/5"
          style="animation-delay: 0.12s"
        >
          <h2 class="text-xl font-semibold">Mode</h2>
          <div class="mt-4 flex flex-wrap items-center gap-3">
            <label class="flex cursor-pointer items-center gap-3">
              <input id="dryrun-toggle" type="checkbox" class="peer sr-only" />
              <span
                class="relative h-8 w-14 rounded-full bg-ink/10 transition peer-checked:bg-tide"
              >
                <span
                  class="absolute left-1 top-1 h-6 w-6 rounded-full bg-white shadow transition peer-checked:translate-x-6"
                ></span>
              </span>
              <span class="text-sm font-medium">Dry run mode</span>
            </label>
            <button
              id="refresh-status"
              class="rounded-full border border-ink/10 bg-white px-4 py-2 text-sm font-medium shadow-sm transition hover:-translate-y-0.5"
            >
              Refresh
            </button>
          </div>
          <p class="mt-3 text-sm text-ink/60">
            Dry run logs G-code without touching the serial port.
          </p>
        </section>

        <section
          class="reveal rounded-3xl border border-ink/10 bg-white/80 p-6 shadow-lg shadow-ink/5"
          style="animation-delay: 0.18s"
        >
          <h2 class="text-xl font-semibold">Serial</h2>
          <form id="connect-form" class="mt-4 grid gap-3">
            <label class="text-sm font-medium text-ink/70">Port</label>
            <input
              id="port-input"
              class="w-full rounded-2xl border border-ink/10 bg-white/80 px-4 py-2 text-sm focus:border-tide focus:outline-none"
              placeholder="/dev/ttyUSB0 or COM3"
            />
            <label class="text-sm font-medium text-ink/70">Baud</label>
            <input
              id="baud-input"
              type="number"
              min="1"
              class="w-full rounded-2xl border border-ink/10 bg-white/80 px-4 py-2 text-sm focus:border-tide focus:outline-none"
              placeholder="250000"
            />
            <div class="mt-2 flex flex-wrap gap-2">
              <button
                type="submit"
                class="rounded-full bg-tide px-5 py-2 text-sm font-semibold text-white shadow-md shadow-tide/30 transition hover:-translate-y-0.5"
              >
                Connect
              </button>
              <button
                id="disconnect-btn"
                type="button"
                class="rounded-full border border-ink/10 bg-white px-5 py-2 text-sm font-medium shadow-sm transition hover:-translate-y-0.5"
              >
                Disconnect
              </button>
            </div>
          </form>
        </section>

        <section
          class="reveal rounded-3xl border border-ink/10 bg-white/80 p-6 shadow-lg shadow-ink/5"
          style="animation-delay: 0.24s"
        >
          <h2 class="text-xl font-semibold">Simulate Gift</h2>
          <form id="gift-form" class="mt-4 grid gap-3">
            <label class="text-sm font-medium text-ink/70">Row ID</label>
            <input
              id="row-input"
              value="row1"
              class="w-full rounded-2xl border border-ink/10 bg-white/80 px-4 py-2 text-sm focus:border-tide focus:outline-none"
            />
            <label class="text-sm font-medium text-ink/70">Count</label>
            <input
              id="count-input"
              type="number"
              min="1"
              value="1"
              class="w-full rounded-2xl border border-ink/10 bg-white/80 px-4 py-2 text-sm focus:border-tide focus:outline-none"
            />
            <button
              type="submit"
              class="rounded-full bg-ink px-5 py-2 text-sm font-semibold text-white shadow-md shadow-ink/20 transition hover:-translate-y-0.5"
            >
              Send Gift
            </button>
          </form>
        </section>

        <section
          class="reveal rounded-3xl border border-ink/10 bg-white/80 p-6 shadow-lg shadow-ink/5"
          style="animation-delay: 0.27s"
        >
          <h2 class="text-xl font-semibold">Jog</h2>
          <div class="mt-3 grid gap-3">
            <div class="grid grid-cols-3 gap-2 text-sm font-medium text-ink/70">
              <label class="flex flex-col gap-1">
                Step (mm)
                <input
                  id="jog-step"
                  type="number"
                  min="0.1"
                  step="0.1"
                  value="5"
                  class="rounded-2xl border border-ink/10 bg-white/80 px-3 py-2 text-sm focus:border-tide focus:outline-none"
                />
              </label>
              <label class="flex flex-col gap-1">
                XY feed (mm/min)
                <input
                  id="jog-feed-xy"
                  type="number"
                  min="1"
                  step="1"
                  value="1200"
                  class="rounded-2xl border border-ink/10 bg-white/80 px-3 py-2 text-sm focus:border-tide focus:outline-none"
                />
              </label>
              <label class="flex flex-col gap-1">
                Z feed (mm/min)
                <input
                  id="jog-feed-z"
                  type="number"
                  min="1"
                  step="1"
                  value="300"
                  class="rounded-2xl border border-ink/10 bg-white/80 px-3 py-2 text-sm focus:border-tide focus:outline-none"
                />
              </label>
            </div>
            <div class="grid grid-cols-3 gap-2">
              <button
                data-jog="y+"
                class="rounded-2xl border border-ink/10 bg-white px-4 py-2 text-sm font-semibold shadow-sm transition hover:-translate-y-0.5"
              >
                +Y
              </button>
              <button
                data-jog="z+"
                class="rounded-2xl border border-ink/10 bg-white px-4 py-2 text-sm font-semibold shadow-sm transition hover:-translate-y-0.5"
              >
                +Z
              </button>
              <button
                data-jog="x+"
                class="rounded-2xl border border-ink/10 bg-white px-4 py-2 text-sm font-semibold shadow-sm transition hover:-translate-y-0.5"
              >
                +X
              </button>
              <button
                data-jog="y-"
                class="rounded-2xl border border-ink/10 bg-white px-4 py-2 text-sm font-semibold shadow-sm transition hover:-translate-y-0.5"
              >
                -Y
              </button>
              <button
                data-jog="home"
                class="rounded-2xl bg-ink px-4 py-2 text-sm font-semibold text-white shadow-md shadow-ink/30 transition hover:-translate-y-0.5"
              >
                G28 Home
              </button>
              <button
                data-jog="x-"
                class="rounded-2xl border border-ink/10 bg-white px-4 py-2 text-sm font-semibold shadow-sm transition hover:-translate-y-0.5"
              >
                -X
              </button>
              <button
                data-jog="z-"
                class="rounded-2xl border border-ink/10 bg-white px-4 py-2 text-sm font-semibold shadow-sm transition hover:-translate-y-0.5"
              >
                -Z
              </button>
              <button
                data-jog="zero"
                class="rounded-2xl border border-ink/10 bg-white px-4 py-2 text-sm font-semibold shadow-sm transition hover:-translate-y-0.5"
              >
                G92 Zero
              </button>
              <div class="rounded-2xl border border-ink/10 bg-white/70 px-3 py-2 text-xs text-ink/60">
                Use small steps; respects firmware limits.
              </div>
            </div>
          </div>
        </section>

        <section
          class="reveal rounded-3xl border border-ink/10 bg-white/80 p-6 shadow-lg shadow-ink/5"
          style="animation-delay: 0.3s"
        >
          <h2 class="text-xl font-semibold">Quick Actions</h2>
          <div class="mt-4 flex flex-wrap gap-2">
            <button
              id="paper-changed"
              class="rounded-full bg-amber-400 px-5 py-2 text-sm font-semibold text-white shadow-md shadow-amber-200/60 transition hover:-translate-y-0.5"
            >
              Paper Changed
            </button>
            <button
              id="reload-mapping"
              class="rounded-full border border-ink/10 bg-white px-5 py-2 text-sm font-medium shadow-sm transition hover:-translate-y-0.5"
            >
              Reload Mapping
            </button>
            <button
              id="zero-position"
              class="rounded-full bg-ink px-5 py-2 text-sm font-semibold text-white shadow-md shadow-ink/30 transition hover:-translate-y-0.5"
            >
              Set XYZ Zero
            </button>
          </div>
          <p class="mt-3 text-sm text-ink/60">
            Paper reset moves row cursors back to their start positions.
          </p>
        </section>

        <section
          class="reveal rounded-3xl border border-ink/10 bg-white/80 p-6 shadow-lg shadow-ink/5 lg:col-span-2"
          style="animation-delay: 0.36s"
        >
          <div class="flex flex-wrap items-center justify-between gap-3">
            <h2 class="text-xl font-semibold">Curl Preview</h2>
            <p class="text-sm text-ink/60">Copy these straight into a terminal.</p>
          </div>
          <div class="mt-4 grid gap-4 md:grid-cols-2">
            <div class="rounded-2xl border border-ink/10 bg-white/70 p-4">
              <div class="flex items-center justify-between text-sm font-medium">
                <span>Dry Run</span>
                <button data-action="send-dryrun" class="text-tide">Send</button>
              </div>
              <pre id="curl-dryrun" class="mt-2 whitespace-pre-wrap text-xs text-ink/70"></pre>
            </div>
            <div class="rounded-2xl border border-ink/10 bg-white/70 p-4">
              <div class="flex items-center justify-between text-sm font-medium">
                <span>Connect</span>
                <button data-action="send-connect" class="text-tide">Send</button>
              </div>
              <pre id="curl-connect" class="mt-2 whitespace-pre-wrap text-xs text-ink/70"></pre>
            </div>
            <div class="rounded-2xl border border-ink/10 bg-white/70 p-4">
              <div class="flex items-center justify-between text-sm font-medium">
                <span>Disconnect</span>
                <button data-action="send-disconnect" class="text-tide">Send</button>
              </div>
              <pre id="curl-disconnect" class="mt-2 whitespace-pre-wrap text-xs text-ink/70"></pre>
            </div>
            <div class="rounded-2xl border border-ink/10 bg-white/70 p-4">
              <div class="flex items-center justify-between text-sm font-medium">
                <span>Simulate Gift</span>
                <button data-action="send-gift" class="text-tide">Send</button>
              </div>
              <pre id="curl-gift" class="mt-2 whitespace-pre-wrap text-xs text-ink/70"></pre>
            </div>
            <div class="rounded-2xl border border-ink/10 bg-white/70 p-4">
              <div class="flex items-center justify-between text-sm font-medium">
                <span>Paper Changed</span>
                <button data-action="send-paper" class="text-tide">Send</button>
              </div>
              <pre id="curl-paper" class="mt-2 whitespace-pre-wrap text-xs text-ink/70"></pre>
            </div>
            <div class="rounded-2xl border border-ink/10 bg-white/70 p-4">
              <div class="flex items-center justify-between text-sm font-medium">
                <span>Reload Mapping</span>
                <button data-action="send-mapping" class="text-tide">Send</button>
              </div>
              <pre id="curl-mapping" class="mt-2 whitespace-pre-wrap text-xs text-ink/70"></pre>
            </div>
            <div class="rounded-2xl border border-ink/10 bg-white/70 p-4">
              <div class="flex items-center justify-between text-sm font-medium">
                <span>Set XYZ Zero</span>
                <button data-action="send-zero" class="text-tide">Send</button>
              </div>
              <pre id="curl-zero" class="mt-2 whitespace-pre-wrap text-xs text-ink/70"></pre>
            </div>
          </div>
        </section>

        <section
          class="reveal rounded-3xl border border-ink/10 bg-white/80 p-6 shadow-lg shadow-ink/5 lg:col-span-2"
          style="animation-delay: 0.42s"
        >
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-semibold">Response Log</h2>
            <button id="clear-log" class="text-sm text-ink/60">Clear</button>
          </div>
          <pre
            id="log-output"
            class="mt-3 max-h-72 overflow-auto rounded-2xl bg-ink/90 p-4 text-xs text-white"
          ></pre>
        </section>
      </main>
    </div>

    <script src="/app.js"></script>
  </body>
</html>
